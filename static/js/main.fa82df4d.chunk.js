(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,a){e.exports=a(53)},40:function(e,t,a){},41:function(e,t,a){},53:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(16),c=a.n(r),i=(a(39),a(11)),o=a(12),l=a(14),u=a(13),m=a(15),d=a(7),h=a(23),p=a(9),v=(a(40),a(10));a(41);function b(e){return!0===e.isMe?s.a.createElement("div",{className:"row justify-content-end"},s.a.createElement("div",{className:"card message-card bg-lightblue m-1"},s.a.createElement("div",{className:"card-body p-2"},s.a.createElement("span",{className:"mx-2"},e.value)))):s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"card message-card m-1"},s.a.createElement("div",{className:"card-body p-2"},s.a.createElement("span",{className:"mx-2"},e.value))))}var g=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).scrollToBottom=function(){a.messagesEnd.scrollIntoView({behavior:"smooth"})},a.scrollToBottom=a.scrollToBottom.bind(Object(d.a)(Object(d.a)(a))),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){var e=this,t=this.props.messages.map(function(e,t){return s.a.createElement(b,{value:e.text,isMe:e.isMe,key:t})});return s.a.createElement("div",{className:"container-fluid message-scroll"},t,s.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}}))}}]),t}(n.Component),f=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).serverNotAvailableMsg="Incerc sa stabilesc conexiunea cu serverul de dialog, incearca te rog peste cateva momente",a.sessionExpiredMsg="Din cauza inactivitatii sesiunea de dialog s-a incheiat, voi deschide o noua conversatie.",a.restoreSessionWelcomeMsg="Bine ai revenit! Te pot ajuta cu trimiterea facturii curente sau cu actualizarea indexului. Scrie-mi daca mai ai nevoie de mine!",a.startUtt="...";return a.apiUrl="".concat("https://cio-dialogsys.herokuapp.com","/api/v1"),a.handleUtteranceChange=a.handleUtteranceChange.bind(Object(d.a)(Object(d.a)(a))),a.handleSubmitFrom=a.handleSubmitFrom.bind(Object(d.a)(Object(d.a)(a))),a.state={dialog:[],apiResponse:{},utterance:""},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=new URL(this.apiUrl+"/message"),a={input:{text:this.state.utterance}};fetch(t,{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"},credentials:"include",mode:"cors"}).then(function(e){if(200===e.status)return e.json()}).then(function(t){t&&e.setState(function(e){var a=Object(v.a)(e.dialog);return t.outputs.forEach(function(e){a.push({isMe:!1,text:e})}),{apiResponse:t,dialog:a}})}).catch(function(t){e.setState(function(t){var a=Object(v.a)(t.dialog);return a.push({isMe:!1,text:e.serverNotAvailableMsg}),{dialog:a}}),console.error("Error:",t)})}},{key:"handleUtteranceChange",value:function(e){var t=e.target.value;"\n"===t.charAt(t.length-1)?this.handleSubmitFrom(e):this.setState({utterance:e.target.value})}},{key:"handleSubmitFrom",value:function(e){var t=this;e.preventDefault(),this.setState({utterance:""});var a=new URL("".concat(this.apiUrl,"/message"));this.setState(function(e){var a=Object(v.a)(e.dialog);return a.push({isMe:!0,text:t.state.utterance}),{dialog:a}});var n={input:{text:this.state.utterance},dialog_state:this.state.apiResponse.dialog_state};fetch(a,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"},credentials:"include",mode:"cors"}).then(function(e){if(200===e.status)return e.json()}).then(function(e){e&&t.setState(function(t){var a=Object(v.a)(t.dialog);return e.outputs.forEach(function(e){a.push({isMe:!1,text:e})}),{apiResponse:e,dialog:a}})}).catch(function(e){t.setState(function(e){var a=Object(v.a)(e.dialog);return a.push({isMe:!1,text:t.serverNotAvailableMsg}),{dialog:a}}),console.error("Error:",e)})}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-header"},s.a.createElement("h5",null,"My Virtual Asisstant")),s.a.createElement("div",{className:"card-body d-flex flex-column p-1"},s.a.createElement(g,{messages:this.state.dialog}),s.a.createElement("form",{onSubmit:this.handleSubmitFrom,className:"mt-3 p-1"},s.a.createElement("div",{className:"input-group"},s.a.createElement("input",{type:"text",className:"form-control",id:"utterance",autoComplete:"off",value:this.state.utterance,onChange:this.handleUtteranceChange,placeholder:this.startUtt}),s.a.createElement("div",{className:"input-group-prepend"},s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Send"))))))))))}}]),t}(n.Component),E=a(55),j=a(56),O=a(57),N=a(61),y=a(58),S=a(59),w=a(60),x=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(l.a)(this,Object(u.a)(t).call(this,e))).toggleNavbar=a.toggleNavbar.bind(Object(d.a)(Object(d.a)(a))),a.state={collapsed:!0},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"toggleNavbar",value:function(){this.setState({collapsed:!this.state.collapsed})}},{key:"render",value:function(){return s.a.createElement(h.a,{basename:"/nlu-demo"},s.a.createElement("div",null,s.a.createElement(E.a,{color:"faded",light:!0,expand:"md"},s.a.createElement(j.a,{href:"/",className:"mr-auto brand-title"},"CIO Dialog System"),s.a.createElement(O.a,{onClick:this.toggleNavbar,className:"mr-2"}),s.a.createElement(N.a,{isOpen:!this.state.collapsed,navbar:!0},s.a.createElement(y.a,{navbar:!0,right:"true",className:"ml-auto"},s.a.createElement(S.a,null,s.a.createElement(w.a,{tag:h.b,to:"/"},"Assistant"))))),s.a.createElement(p.a,{path:"/",component:f})))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[34,1,2]]]);
//# sourceMappingURL=main.fa82df4d.chunk.js.map